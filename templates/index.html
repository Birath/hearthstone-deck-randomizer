<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hearthstone deck randomizer</title>
</head>
<body>
    <h1>Hearthstone deck randomizer</h1>
    <form>
        {% csrf_token %}
        {{ name_form }}
        <input type="button" value="Import Collection" id="import-collection"/>
    </form>
    <p id="import-response"></p>
    <form>
        {% csrf_token  %}
        {{ hero_form }}
        {{ format_form }}
       <input type="button" value="Enter" id="submit"/>
    </form>
    <div id="deck">
        {% include 'deck.html' %}
    </div>


<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous">
</script>

</body>

<script>
    $('#import-collection').click(function () {
        event.preventDefault();
        console.log('Importing collection');
        document.getElementById('import-response').innerHTML = "Importing collection...";
        $.ajax({
            url: 'import_collection',
            data: {
                'name':  $('#id_name').val()
            },
            dataType: 'json',
            success: function (data) {
                document.getElementById('import-response').innerHTML = data['response']
            }
        })

    });
    // Sends chosen class and format to the server and which generate
    // and returns a deck which is rendered
    $('#submit').click(function () {
        event.preventDefault();
        console.log('Clicked');
        $.ajax({
            url: 'deck',
            data: {
                'hero' : $('#id_hero').val(),
                'format' : $('#id_deck_format').val()
            },
            dataType: 'html',
            success: function (data) {
                console.log('Loading html');
                $('#deck').html(data)

            }

        })
    });
</script>
</html>